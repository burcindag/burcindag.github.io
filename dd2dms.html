<!DOCTYPE html>
<html>
  <head>
    <title>Coordinate Converter</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
	body {
		font-family: Arial, sans-serif;
		font-size: 100%;
	}
	select {
		width: 100%;
		font-size: 1.0em;
	}
	h1 {
		text-align: center;
	}
	.container {
		max-width: 800px;
		margin: 0 auto;
		padding: 20px;
	}
	.label-type {
		display: block;
		font-weight: bold;
		margin-bottom: 10px;
	}
	input[type="text"] {
		width: 100%;
		padding: 10px;
		margin: 10px 0;
		border: 1px solid #ccc;
		border-radius: 1px;
		box-sizing: border-box;
	}
	input[type="submit"] {
		background-color: #4caf50;
		color: white;
		padding-top: 12px;
		padding-bottom: 12px;
		border: none;
		border-radius: 2px;
		cursor: pointer;
		width: 100%;
	}
	input[type="submit"]:hover {
		background-color: #45a049;
	}
	.result {
		margin-top: 10px;
		border: 1px solid #ccc;
		border-radius: 2px;
		background-color: #d6eaf8;
		text-align: center;
		padding-top: 12px;
		padding-bottom: 12px;
	}
	.return-button {
	    display: inline-block;
	    background-color: #1dabde;
	    color: white;
		padding-top: 12px;
		padding-bottom: 12px;
	    border: none;
	    border-radius: 2px;
	    cursor: pointer;
	    width: 100%;
	    text-align: center;
	    text-decoration: none;
	    margin-top: 10px;
  	}
  	.return-button:hover {
    	background-color: #1c8eb8;
  	}
    </style>
    <script>
	  // DMS formatındaki bir dizgeyi (string) (örneğin "39° 55' 30.1980\" N") Decimal Degrees'e dönüştürür
	  function dmsToDecimal(dmsString) {
		// Sayıları ve ondalık noktaları ayırır
		var parts = dmsString.split(/[^\d\.]+/).filter(Boolean);

		if (parts.length < 3) return NaN;

		var degrees = parseFloat(parts[0]);
		var minutes = parseFloat(parts[1]);
		var seconds = parseFloat(parts[2]);

		if (isNaN(degrees) || isNaN(minutes) || isNaN(seconds)) return NaN;

		// Decimal Degrees hesaplaması
		var decimal = degrees + (minutes / 60) + (seconds / 3600);
		
		// Yön (N, S, E, W) kontrolü
		var sign = 1;
		if (dmsString.toUpperCase().includes('S') || dmsString.toUpperCase().includes('W')) {
			sign = -1;
		}

		return decimal * sign;
	  }

	  function validateInput() {
		var type = document.getElementById("type").value;
		var valid = true;

		// Decimal Degrees'ten diğer formatlara dönüşüm kontrolleri
		if (type === "decimal-to-dms" || type === "decimal-to-ddm") {
			var lat = document.getElementById("lat").value;
			var lon = document.getElementById("lon").value;
			if (isNaN(lat) || parseFloat(lat) < -90 || parseFloat(lat) > 90) {
			  alert("Latitude (Enlem) -90 ile 90 derece arasında bir sayı olmalıdır.");
			  valid = false;
			}
			if (valid && (isNaN(lon) || parseFloat(lon) < -180 || parseFloat(lon) > 180)) {
			  alert("Longitude (Boylam) -180 ile 180 derece arasında bir sayı olmalıdır.");
			  valid = false;
			}
		}

		// DMS'ten diğer formatlara dönüşüm kontrolleri
		if (type === "dms-to-decimal" || type === "dms-to-ddm") {
			var dmsLat = document.getElementById("dms-lat").value;
			var dmsLon = document.getElementById("dms-lon").value;

			// DMS formatının Decimal'e dönüştürülüp dönüştürülemeyeceğini kontrol et
			var decimalLat = dmsToDecimal(dmsLat);
			var decimalLon = dmsToDecimal(dmsLon);

			if (isNaN(decimalLat) || decimalLat < -90 || decimalLat > 90) {
				alert("Geçersiz Latitude (Enlem) DMS formatı. Örnek: 39° 55' 30.1980\" N");
				valid = false;
			}
			if (valid && (isNaN(decimalLon) || decimalLon < -180 || decimalLon > 180)) {
				alert("Geçersiz Longitude (Boylam) DMS formatı. Örnek: 32° 50' 13.4808\" E");
				valid = false;
			}
		}
		
		if (valid) {
		  convert(type);
		}
	  }

      function convert(type) {
        var result = document.getElementById("result");
        
        if (type == "dms-to-decimal") {
          // DMS → Decimal Degrees
          var dmsLat = document.getElementById("dms-lat").value;
          var dmsLon = document.getElementById("dms-lon").value;
          
          var lat = dmsToDecimal(dmsLat);
          var lon = dmsToDecimal(dmsLon);

          result.innerHTML = "Decimal Degrees: " + lat.toFixed(6) + ", " + lon.toFixed(6);

        } else if (type == "dms-to-ddm") {
          // DMS → Degree Decimal Minutes (DDM)
          var dmsLat = document.getElementById("dms-lat").value;
          var dmsLon = document.getElementById("dms-lon").value;
          
          // Önce Decimal Degrees'e dönüştür
          var lat = dmsToDecimal(dmsLat);
          var lon = dmsToDecimal(dmsLon);

          // Ardından Decimal Degrees'ten DDM'e dönüştür
          var latDeg = Math.floor(Math.abs(lat));
          var latMin = (Math.abs(lat) - latDeg) * 60;
          var lonDeg = Math.floor(Math.abs(lon));
          var lonMin = (Math.abs(lon) - lonDeg) * 60;
          
          var latDirection = lat >= 0 ? "N" : "S";
          var lonDirection = lon >= 0 ? "E" : "W";
          
          result.innerHTML = "Degree Decimal Minutes: " + latDeg + "° " + latMin.toFixed(4) + "' " + latDirection + ", " +
            lonDeg + "° " + lonMin.toFixed(4) + "' " + lonDirection;

        } else if (type == "decimal-to-dms") {
          // Decimal Degrees → DMS
          var lat = parseFloat(document.getElementById("lat").value);
          var lon = parseFloat(document.getElementById("lon").value);
          var absLat = Math.abs(lat);
          var absLon = Math.abs(lon);

          var latDeg = Math.floor(absLat);
          var latMin = Math.floor((absLat - latDeg) * 60);
          var latSec = ((absLat - latDeg - latMin / 60) * 3600).toFixed(4);
          var lonDeg = Math.floor(absLon);
          var lonMin = Math.floor((absLon - lonDeg) * 60);
          var lonSec = ((absLon - lonDeg - lonMin / 60) * 3600).toFixed(4);

          var latDirection = lat >= 0 ? "N" : "S";
          var lonDirection = lon >= 0 ? "E" : "W";

          result.innerHTML = "DMS: " + latDeg + "° " + latMin + "' " + latSec + "\" " + latDirection + ", " +
            lonDeg + "° " + lonMin + "' " + lonSec + "\" " + lonDirection;

        } else if (type == "decimal-to-ddm") {
          // Decimal Degrees → Degree Decimal Minutes
          var lat = parseFloat(document.getElementById("lat").value);
          var lon = parseFloat(document.getElementById("lon").value);
          var absLat = Math.abs(lat);
          var absLon = Math.abs(lon);

          var latDeg = Math.floor(absLat);
          var latMin = ((absLat - latDeg) * 60).toFixed(4);
          var lonDeg = Math.floor(absLon);
          var lonMin = ((absLon - lonDeg) * 60).toFixed(4);
          
          var latDirection = lat >= 0 ? "N" : "S";
          var lonDirection = lon >= 0 ? "E" : "W";

          result.innerHTML = "Degree Decimal Minutes: " + latDeg + "° " + latMin + "' " + latDirection + ", " +
            lonDeg + "° " + lonMin + "' " + lonDirection;
        }
	  }
    </script>
  </head>
  <body>
    <h1>Coordinate Converter</h1>
    <p>Enter latitude and longitude:</p>
	<select id="type" name="type">
      		<option value="decimal-to-dms">Decimal Degrees → DMS Dönüştür</option>
      		<option value="dms-to-decimal">DMS → Decimal Degrees Dönüştür</option>
          <option value="dms-to-ddm">DMS → Degree Decimal Minutes Dönüştür</option> <option value="decimal-to-ddm">Decimal Degrees → Degree Decimal Minutes Dönüştür</option>
    	</select>
	<br><br>
	<div id="dd" style="display:block;">
		<label for="lat">Latitude (Decimal Degrees):</label>
		<input type="text" id="lat" name="lat" value="39.925055"/>
		<label for="lon">Longitude (Decimal Degrees):</label>
		<input type="text" id="lon" name="lon" value="32.837078"/>
	</div>

    <div id="dms" style="display:none;">
      <label for="dms-lat">Latitude (DMS):</label>
      <input type="text" id="dms-lat" name="dms-lat" value="39° 55' 30.1980&quot; N"/>
      <label for="dms-lon">Longitude (DMS):</label>
      <input type="text" id="dms-lon" name="dms-lon" value="32° 50' 13.4808&quot; E"/>
      <p style="font-size:0.9em; color:#666;">*Örnek format: 39° 55' 30.1980" N</p>
    </div>

    <input type="submit" value="CONVERT" onclick="validateInput();" />
    <div class="result" id="result"></div>
	<a href="/" class="return-button">Return Home</a>
    <script>
      // Sayfa yüklendiğinde ve seçim değiştiğinde girdi alanlarını göster/gizle
      document.getElementById("type").addEventListener("change", function() {
        var type = this.value;
        var dms = document.getElementById("dms");
		    var dd = document.getElementById("dd");
        
        if (type.includes("dms-to-")) {
          dms.style.display = "block";
		      dd.style.display = "none";
        } else {
          dms.style.display = "none";
		      dd.style.display = "block";
        }
      });
      // İlk yüklemede doğru alanları göster
      document.getElementById("type").dispatchEvent(new Event('change'));
    </script>
  </body>
</html>
